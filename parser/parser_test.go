package parser

import (
	"bytes"
	"encoding/hex"
	"testing"
	"encoding/xml"
	"fmt"
	"strings"
)

/////////////// Create Destroy /////////////////////////////////


func TestPackUnpackRequest(t *testing.T) {
	d := []string{
		/*"42007801000001504200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000010842005C0500000004000000010000000042007901000000F04200570500000004000000020000000042009101000000D8420008010000003042000A070000001743727970746F6772617068696320416C676F726974686D0042000B05000000040000000300000000420008010000003042000A070000001443727970746F67726170686963204C656E6774680000000042000B02000000040000008000000000420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000C00000000420008010000002842000A0700000004782D49440000000042000B070000000954432D3331312D313200000000000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C050000000400000014000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000002384200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F01000001F042005C0500000004000000030000000042007901000001D8420057050000000400000006000000004200910100000080420008010000004842000A07000000044E616D650000000042000B0100000030420055070000001354432D3331322D31322D74656D706C61746531000000000042005405000000040000000100000000420008010000002842000A0700000004782D49440000000042000B070000000954432D3331322D3132000000000000004200900100000138420008010000002842000A070000000C4F626A6563742047726F75700000000042000B070000000647726F7570310000420008010000005842000A07000000204170706C69636174696F6E20537065636966696320496E666F726D6174696F6E42000B0100000028420003070000000373736C0000000000420002070000000F7777772E6578616D706C652E636F6D00420008010000003042000A0700000013436F6E7461637420496E666F726D6174696F6E000000000042000B07000000034A6F650000000000420008010000003042000A0700000009782D507572706F73650000000000000042000B070000000D64656D6F6E7374726174696F6E000000420008010000003042000A0700000004782D49440000000042000B070000001754432D3331322D31322D66726F6D2D74656D706C61746500",
		"42007801000001D84200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000019042005C0500000004000000010000000042007901000001784200570500000004000000020000000042009101000001604200530100000030420055070000001354432D3331322D31322D74656D706C61746531000000000042005405000000040000000100000000420008010000003042000A070000001743727970746F6772617068696320416C676F726974686D0042000B05000000040000000300000000420008010000003042000A070000001443727970746F67726170686963204C656E6774680000000042000B02000000040000008000000000420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000C00000000420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000E54432D3331322D31322D6B657931000042005405000000040000000100000000420008010000003042000A0700000004782D49440000000042000B070000001554432D3331322D31322D66726F6D2D637265617465000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C05000000040000000B000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3100000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C05000000040000000B000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C05000000040000000A000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C050000000400000014000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3100000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C050000000400000014000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000001684200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000012042005C0500000004000000010000000042007901000001084200570500000004000000020000000042009101000000F0420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000E54432D3331332D31322D6B657931000042005405000000040000000100000000420008010000003042000A070000001743727970746F6772617068696320416C676F726974686D0042000B05000000040000000200000000420008010000003042000A070000001443727970746F67726170686963204C656E6774680000000042000B0200000004000000A800000000420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000C00000000",
		"42007801000000D84200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000009042005C050000000400000008000000004200790100000078420008010000002842000A070000000B4F626A6563742054797065000000000042000B05000000040000000200000000420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000E54432D3331332D31322D6B657931000042005405000000040000000100000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C05000000040000000A000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000000D04200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000008842005C050000000400000008000000004200790100000070420008010000002042000A0700000005537461746500000042000B05000000040000000100000000420008010000004042000A0700000011556E69717565204964656E7469666965720000000000000042000B070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C050000000400000014000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000000D04200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000008842005C050000000400000008000000004200790100000070420008010000002042000A0700000005537461746500000042000B05000000040000000100000000420008010000004042000A0700000011556E69717565204964656E7469666965720000000000000042000B070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000001404200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F01000000F842005C0500000004000000030000000042007901000000E0420057050000000400000006000000004200910100000050420008010000004842000A07000000044E616D650000000042000B0100000030420055070000001354432D3331342D31322D74656D706C617465310000000000420054050000000400000001000000004200900100000070420008010000003042000A070000001743727970746F6772617068696320416C676F726974686D0042000B05000000040000000300000000420008010000003042000A070000001443727970746F67726170686963204C656E6774680000000042000B02000000040000008000000000",
		"42007801000001684200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000012042005C0500000004000000010000000042007901000001084200570500000004000000020000000042009101000000F04200530100000030420055070000001354432D3331342D31322D74656D706C61746531000000000042005405000000040000000100000000420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000E54432D3331342D31322D6B657931000042005405000000040000000100000000420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000400000000420008010000003042000A0700000013436F6E7461637420496E666F726D6174696F6E000000000042000B0700000003466F6F0000000000",
		"42007801000001284200770100000048420069010000002042006A0200000004000000010000000042006B020000000400000002000000004200100600000008000000000000000142000D0200000004000000020000000042000F01000000A042005C050000000400000008000000004200930800000008aa21f8c659d6e10d4200790100000078420008010000002842000A070000000B4F626A6563742054797065000000000042000B05000000040000000200000000420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000E54432D3331342D31322D6B65793100004200540500000004000000010000000042000F010000002842005C05000000040000000A000000004200930800000008495a95f165854d1e4200790100000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C05000000040000000C000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3100000000",
		"42007801000000B04200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000006842005C05000000040000000B000000004200790100000050420094070000001424554E495155455F4944454E5449464945525F310000000042000A07000000044E616D650000000042000A0700000013436F6E7461637420496E666F726D6174696F6E0000000000",
		"42007801000001404200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000020000000042000F010000007842005C05000000040000000D00000000420093080000000832d84369c120488e4200790100000050420094070000001424554E495155455F4944454E5449464945525F3100000000420008010000002842000A070000000C782D617474726962757465310000000042000B070000000656616C756531000042000F010000007842005C05000000040000000D000000004200930800000008519cf4f0ec1ac13f4200790100000050420094070000001424554E495155455F4944454E5449464945525F3100000000420008010000002842000A070000000C782D617474726962757465320000000042000B070000000656616C7565320000",
		"42007801000001504200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000020000000042000F010000008042005C05000000040000000E000000004200930800000008fce08e45995686b64200790100000058420094070000001424554E495155455F4944454E5449464945525F3100000000420008010000003042000A070000000C782D617474726962757465310000000042000B070000000E4D6F64696669656456616C756531000042000F010000008042005C05000000040000000E000000004200930800000008dc2bfda88f39f5fc4200790100000058420094070000001424554E495155455F4944454E5449464945525F3100000000420008010000003042000A070000000C782D617474726962757465320000000042000B070000000E4D6F64696669656456616C7565320000",
		"42007801000001104200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000020000000042000F010000006042005C05000000040000000F000000004200930800000008ba8d4889753b74144200790100000038420094070000001424554E495155455F4944454E5449464945525F310000000042000A070000000C782D617474726962757465310000000042000F010000006042005C05000000040000000F00000000420093080000000888fa2f142c615edb4200790100000038420094070000001424554E495155455F4944454E5449464945525F310000000042000A070000000C782D6174747269627574653200000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C050000000400000014000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3100000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C05000000040000000A000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3100000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C050000000400000014000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C05000000040000000A000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000001304200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F01000000E842005C0500000004000000030000000042007901000000D0420057050000000400000007000000004200910100000068420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000200000000420008010000002842000A0700000004782D49440000000042000B070000000954432D3331352D3132000000000000004200850100000048420086050000000400000001000000004200400100000030420042050000000400000002000000004200450100000018420043080000000E53656372657450617373776f72640000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C050000000400000014000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000001984200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000015042005C050000000400000001000000004200790100000138420057050000000400000002000000004200910100000120420008010000003042000A070000001743727970746F6772617068696320416C676F726974686D0042000B05000000040000000300000000420008010000003042000A070000001443727970746F67726170686963204C656E6774680000000042000B02000000040000008000000000420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000D54432D33322D31322D6B65793100000042005405000000040000000100000000420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000400000000420008010000002842000A070000000C4F626A6563742047726F75700000000042000B070000000647726F7570310000",
		"42007801000000E84200770100000048420069010000002042006A0200000004000000010000000042006B020000000400000002000000004200070600000008000000000000000142000D0200000004000000010000000042000F010000009042005C050000000400000008000000004200790100000078420008010000002842000A070000000B4F626A6563742054797065000000000042000B05000000040000000200000000420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000D54432D33322D31322D6B65793100000042005405000000040000000100000000",
		"42007801000000884200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000004042005C05000000040000001A000000004200790100000028420006080000001F244153594E4348524F4E4F55535F434F5252454C4154494F4E5F56414C554500",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C05000000040000000A000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000000D04200770100000048420069010000002042006A0200000004000000010000000042006B020000000400000002000000004200070600000008000000000000000142000D0200000004000000010000000042000F010000007842005C050000000400000008000000004200790100000060420008010000002842000A070000000B4F626A6563742054797065000000000042000B05000000040000000200000000420008010000002842000A070000000C4F626A6563742047726F75700000000042000B070000000647726F7570310000",
		"42007801000000884200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000004042005C05000000040000001A000000004200790100000028420006080000001F244153594E4348524F4E4F55535F434F5252454C4154494F4E5F56414C554500",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C05000000040000000A000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000000E84200770100000048420069010000002042006A0200000004000000010000000042006B020000000400000002000000004200070600000008000000000000000142000D0200000004000000010000000042000F010000009042005C050000000400000008000000004200790100000078420008010000002842000A070000000B4F626A6563742054797065000000000042000B05000000040000000200000000420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000D54432D33322D31322D6B65793100000042005405000000040000000100000000",
		"42007801000000884200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000004042005C050000000400000019000000004200790100000028420006080000001F244153594E4348524F4E4F55535F434F5252454C4154494F4E5F56414C554500",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C050000000400000014000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000001684200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000012042005C0500000004000000010000000042007901000001084200570500000004000000020000000042009101000000F0420008010000003042000A070000001743727970746F6772617068696320416C676F726974686D0042000B05000000040000000300000000420008010000003042000A070000001443727970746F67726170686963204C656E6774680000000042000B02000000040000008000000000420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000D54432D34312D31322D6B65793100000042005405000000040000000100000000420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000400000000",
		"42007801000000904200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000004842005C05000000040000000B000000004200790100000030420094070000001424554E495155455F4944454E5449464945525F300000000042000A07000000055374617465000000",
		"42007801000000804200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000003842005C050000000400000012000000004200790100000020420094070000001424554E495155455F4944454E5449464945525F3000000000",
		"42007801000000904200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000004842005C05000000040000000B000000004200790100000030420094070000001424554E495155455F4944454E5449464945525F300000000042000A07000000055374617465000000",
		"42007801000000D84200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000009042005C050000000400000008000000004200790100000078420008010000002842000A070000000B4F626A6563742054797065000000000042000B05000000040000000200000000420008010000004042000A07000000044E616D650000000042000B0100000028420055070000000D54432D34312D31322D6B65793100000042005405000000040000000100000000",
		"42007801000000A84200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000006042005C050000000400000013000000004200790100000048420094070000001424554E495155455F4944454E5449464945525F300000000042008101000000104200820500000004000000020000000042002109000000080000000000000006",
		"42007801000001404200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000020000000042000F010000007842005C05000000040000000D00000000420093080000000823a177faa569463c4200790100000050420094070000001424554E495155455F4944454E5449464945525F3000000000420008010000002842000A070000000C782D617474726962757465310000000042000B070000000656616C756531000042000F010000007842005C05000000040000000D0000000042009308000000089b898dc0577f80804200790100000050420094070000001424554E495155455F4944454E5449464945525F3000000000420008010000002842000A070000000C782D617474726962757465320000000042000B070000000656616C7565320000",
		"42007801000001504200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000020000000042000F010000008042005C05000000040000000E0000000042009308000000080752c951bb9926cc4200790100000058420094070000001424554E495155455F4944454E5449464945525F3000000000420008010000003042000A070000000C782D617474726962757465310000000042000B070000000E4D6F64696669656456616C756531000042000F010000008042005C05000000040000000E00000000420093080000000833f55c8d7e6cafbf4200790100000058420094070000001424554E495155455F4944454E5449464945525F3000000000420008010000003042000A070000000C782D617474726962757465320000000042000B070000000E4D6F64696669656456616C7565320000",
		"42007801000001104200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000020000000042000F010000006042005C05000000040000000F000000004200930800000008a3eb249b495e8ad24200790100000038420094070000001424554E495155455F4944454E5449464945525F300000000042000A070000000C782D617474726962757465310000000042000F010000006042005C05000000040000000F000000004200930800000008c1fe7b3b4c9777304200790100000038420094070000001424554E495155455F4944454E5449464945525F300000000042000A070000000C782D6174747269627574653200000000",
		"42007801000001504200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000020000000042000F010000008042005C05000000040000000E0000000042009308000000080752c951bb9926cc4200790100000058420094070000001424554E495155455F4944454E5449464945525F3000000000420008010000003042000A070000000C782D617474726962757465310000000042000B070000000E4D6F64696669656456616C756531000042000F010000008042005C05000000040000000E00000000420093080000000833f55c8d7e6cafbf4200790100000058420094070000001424554E495155455F4944454E5449464945525F3000000000420008010000003042000A070000000C782D617474726962757465320000000042000B070000000E4D6F64696669656456616C7565320000",
		"42007801000001384200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F01000000F042005C0500000004000000030000000042007901000000D8420057050000000400000002000000004200910100000060420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000400000000420008010000002042000A0700000004782D49440000000042000B070000000854432D36312D313242008F0100000058420040010000005042004205000000040000000100000000420045010000001842004308000000100123456789abcdef0123456789abcdef4200280500000004000000030000000042002A02000000040000008000000000",
		"42007801000000B04200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000006842005C05000000040000000D000000004200790100000050420094070000001424554E495155455F4944454E5449464945525F3000000000420008010000002842000A070000000A782D70726F766964657200000000000042000B0700000007756E6B6E6F776E00",
		"42007801000000B84200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000007042005C05000000040000000E000000004200790100000058420094070000001424554E495155455F4944454E5449464945525F3000000000420008010000003042000A070000000A782D70726F766964657200000000000042000B070000000B74686972642070617274790000000000",*/
		// Unrecognized Message Extension with Criticality Indicator False -- missing
		//  Unrecognized Message Extension with Criticality Indicator True -- missing

		"42007801000001F84200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F01000001B042005C05000000040000000200000000420079010000019842001F0100000070420008010000003042000A070000001743727970746F6772617068696320416C676F726974686D0042000B05000000040000000400000000420008010000003042000A070000001443727970746F67726170686963204C656E6774680000000042000B020000000400000400000000004200650100000088420008010000004842000A07000000044E616D650000000042000B0100000030420055070000001454432D38312D31322D707269766174656B6579310000000042005405000000040000000100000000420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B0200000004000000010000000042006E0100000088420008010000004842000A07000000044E616D650000000042000B0100000030420055070000001354432D38312D31322D7075626C69636B657931000000000042005405000000040000000100000000420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000200000000",
		"42007801000000E04200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000009842005C050000000400000008000000004200790100000080420008010000002842000A070000000B4F626A6563742054797065000000000042000B05000000040000000400000000420008010000004842000A07000000044C696E6B0000000042000B010000003042004B0500000004000001020000000042004C070000001424554E495155455F4944454E5449464945525F3100000000",
		"42007801000003B04200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000036842005C050000000400000003000000004200790100000350420057050000000400000004000000004200910100000068420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000100000000420008010000002842000A0700000004782D49440000000042000B070000000F54432D38322D31322D7072696B65790042006401000002C842004001000002C0420042050000000400000004000000004200450100000288420043080000027A30820276020100300d06092a864886f70d0101010500048202603082025c02010002818100930451c9ecd94f5bb9da17dd09381bd23be43eca8c7539f301fc8a8cd5d5274c3e7699dbdc711c97a7aa91e2c50a82bd0b1034f0df493dec16362427e58acce7f6ce0f9bcc617bbd8c90d0094a2703ba0d09eb19d1005f2fb265526aac75af32f8bc782cded2a57f811e03eaf67a944de5e78413dca8f232d074e6dcea4cec9f02030100010281800b6a7d736199ea48a420e4537ca0c7c046784dcbeaa63baebc0bc132787449cde8d7cad0c0c863c0fefb06c3062befc50033ecf87b4e33a9be7bcbc8f1511ae215e80deb5d8af2bd31319d7821196640935a0cd67c94599579f2100d65e038831fdafb0dbe2bbdac00a696e67e756350e1c99ace11a36dabac3ed3e730960059024100ddf672fbcc5bda3d73affc4e791e0c03390224405d69ccaabc749faa0dcd4c2583c71dde8941a7b9aa030f52ef1451466c074d4d338fe677892acd9e10fd35bd024100a98fbc3ed6b4c6f860f97165ac2f7bb6f2e2cb192a9abd49795be5bcf37d8ee69a6e169c24e5c32e4e7fa33265461407f952ba49e204818a2f785f113f922b8b0240253f9470390d39049303777ddbc9750e9d64849ce0903eae704dc9f589b7680deb9d609fd5bcd4decd6f120542e5cff5d76f2a43c8615fb5b3a9213463797aa9024100a1ddf023c0cd94c019bb26d09b9e3ca8fa971cb16aa58b9baf79d6081a1dbba452ba53653e2804ba98ff69e8bb1b3a161ea225ea501463216a8dab9b88a75e5f02406178646e112cf79d921a8a843f17f6e7ff974f688122365bf6690cdfc996e1890952eb3820dd1890ec1c8619e87a2bd38f9d03b37fac742efb748c7885942c390000000000004200280500000004000000040000000042002A02000000040000040000000000",
		"42007801000002284200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F01000001E042005C0500000004000000030000000042007901000001C84200570500000004000000030000000042009101000000B8420008010000003042000A070000001843727970746F67726170686963205573616765204D61736B42000B02000000040000000200000000420008010000004842000A07000000044C696E6B0000000042000B010000003042004B0500000004000001030000000042004C070000001424554E495155455F4944454E5449464945525F3000000000420008010000002842000A0700000004782D49440000000042000B070000000F54432D38322D31322D7075626B65790042006D01000000F042004001000000E84200420500000004000000050000000042004501000000B042004308000000A230819f300d06092a864886f70d010101050003818d0030818902818100930451c9ecd94f5bb9da17dd09381bd23be43eca8c7539f301fc8a8cd5d5274c3e7699dbdc711c97a7aa91e2c50a82bd0b1034f0df493dec16362427e58acce7f6ce0f9bcc617bbd8c90d0094a2703ba0d09eb19d1005f2fb265526aac75af32f8bc782cded2a57f811e03eaf67a944de5e78413dca8f232d074e6dcea4cec9f02030100010000000000004200280500000004000000040000000042002A02000000040000040000000000",
		"42007801000000D04200770100000038420069010000002042006A0200000004000000010000000042006B0200000004000000020000000042000D0200000004000000010000000042000F010000008842005C05000000040000000D000000004200790100000070420094070000001424554E495155455F4944454E5449464945525F3000000000420008010000004842000A07000000044C696E6B0000000042000B010000003042004B0500000004000001020000000042004C070000001424554E495155455F4944454E5449464945525F3100000000",




	}





	for _, s := range d {

		t.Run(t.Name(),func(t *testing.T){
			b := bytes.Buffer{}
			d, _ := hex.DecodeString(s)
			b.Write(d)
			r := Parser(&b)
			x,_ := xml.MarshalIndent(r, "", "  ")
			fmt.Println(string(x))
			data := MarshalAllRequest(r)
			fmt.Println(strings.ToUpper(hex.EncodeToString(data)))
			fmt.Println(strings.ToUpper(s))
			if strings.ToUpper(hex.EncodeToString(data)) != strings.ToUpper(s) {
				t.FailNow()
			}
		})

	}
}

/*
func TestStringArray(t *testing.T) {
	k := &KmipStruct{}
	k.RequestMessage = &RequestMessage{}
	k.RequestMessage.RequestHeader = &RequestHeader{}
	var kk kmipbin.KmipInt
	kk = kmipbin.KmipInt(7)
	k.RequestMessage.RequestHeader.BatchCount = &kk
	bitem := &BatchItem{}
	bitem.RequestPayload = &RequestPayload{}

	//issuer1 := kmipbin.KmipTextString("123456")
	//issuer2 := kmipbin.KmipTextString("654321")

	//bitem.RequestPayload.Issuer = append(bitem.RequestPayload.Issuer , &issuer1 , &issuer2)


	k.RequestMessage.BatchItem = append(k.RequestMessage.BatchItem, bitem)


	b := MarshalAllRequest(k)

	h := hex.EncodeToString(b)
	fmt.Println(h)

	b1 := bytes.Buffer{}
	d, _ := hex.DecodeString(h)
	b1.Write(d)
	Parser(&b1)
}
*/


/*
func TestParser_Marshal(t *testing.T) {

	k := &KmipStructResponse{}
	k.ResponseMessage = &ResponseMessage{}
	k.ResponseMessage.ResponseHeader = &ResponseHeader{}
	var kk kmipbin.KmipInt
	kk = kmipbin.KmipInt(7)
	k.ResponseMessage.ResponseHeader.BatchCount = &kk
	var gg = kmipbin.KmipByteString{0x40, 0x41, 0x40, 0x41, 0x40, 0x41}
	k.ResponseMessage.BatchItem = append(k.ResponseMessage.BatchItem, &BatchItem{UniqueBatchItemID: &gg})
	b := MarshalAllT(k)

	h := hex.EncodeToString(b)
	fmt.Println(h)

}*/
